<html>
<head><title>Encrypt String</title>
	<HTA:APPLICATION ID="oHTA";
		APPLICATIONNAME="Encrypt String";
		BORDER="thin";
		BORDERSTYLE="normal";
		SINGLEINSTANCE="no";
		MAXIMIZEBUTTON ="no";
		MAXIMIZEBUTTON ="no";
	/>
	<style>
		body {
		background-color:#E8E8E8;
		font:13px "Century Gothic";
		color:#000;
		hr {
		color:#000;
		.title {
		font-weight:700;
	</style>
</head>
<script type="text/vbscript">
	Dim localeOriginal
	
	Sub Window_OnLoad
		self.resizeTo 610, 165
		localeOriginal = SetLocale("en-gb")
	End Sub
	
	Sub Window_OnClose
		self.resizeTo 610, 165
		SetLocale localeOriginal
	End Sub

	Sub btnEncrypt_onClick
		sEncrypted.value = Encrypt(sSource.Value, key)
	End Sub

	Sub btnDecrypt_onClick
		sDecrypted.value = Decrypt(sEncrypted.Value, key)
	End Sub
	
	Sub btnClear_onClick
		sDecrypted.value = ""
	End Sub

	Sub btnExit_onClick
		ExitHTA
	End Sub

	Sub ExitHTA
		strComputer = "."
		Set objWMIService = GetObject("winmgmts:" & "{impersonationLevel=impersonate}!\\" & strComputer & "\root\cimv2")
		Set colProcessList = objWMIService.ExecQuery ("Select * from Win32_Process Where Name = 'mshta.exe'")
		For Each objProcess in colProcessList
			objProcess.Terminate()
		Next
	End Sub


	Function encrypt(Str, key)
		Dim lenKey, KeyPos, LenStr, x, Newstr

		Newstr = ""
		lenKey = Len(key)
		KeyPos = 1
		LenStr = Len(Str)
		str = StrReverse(str)
		For x = 1 To LenStr
			Newstr = Newstr & chr(asc(Mid(str,x,1)) + Asc(Mid(key,KeyPos,1)))
			KeyPos = keypos+1
			If KeyPos > lenKey Then KeyPos = 1
		Next
		encrypt = Newstr
	End Function

	Function Decrypt(str,key)
		Dim lenKey, KeyPos, LenStr, x, Newstr

		Newstr = ""
		lenKey = Len(key)
		KeyPos = 1
		LenStr = Len(Str)

		str=StrReverse(str)
		For x = LenStr To 1 Step -1
		  Newstr = Newstr & chr(asc(Mid(str,x,1)) - Asc(Mid(key,KeyPos,1)))
		  KeyPos = KeyPos+1
		  If KeyPos > lenKey Then KeyPos = 1
		Next

		Newstr=StrReverse(Newstr)
		Decrypt = Newstr
	End Function

	bDebug = False
	key = "encryption"

	Sub DebugMessage(sMessage)
		If bDebug = True then MsgBox "DEBUG:" & sMessage
	End Sub
</script>

<body>
	<table>
	<tr>
	<td> Source: </td>
	<td><span id="String"> <input type="password" size="60" name="sSource" value="" title="Type your string here and press Encrypt"> </td>
    <td><input type="submit" name="btnEncrypt" value="Encrypt"></td>
    </tr>
	<tr>
    <td> Encrypted: </td>
	<td> <span id="String"><input type="text" size="60" name="sEncrypted" value="" title="Type your string here and press Decrypt"> </td>
    <td><input type="submit" name="btnDecrypt" value="Decrypt" title="Privacy Warning. If you click Decrypt then the decrypted string will appear below."></td>
    </tr>
	<tr>
    <td> Decrypted: </td>
	<td> <span id="String"><input type="text" size="60" name="sDecrypted" value="" title="Privacy Warning. If you click Decrypt then the decrypted string will appear here."> </td>
	<td><input type="submit" name="btnClear" value="Clear" title="Click here to clear the Decrypted field"></td>
    </tr>
	<tr>
	<td><input type="submit" name="btnExit" value="E X I T" title="Click to Exit"></td>
    </tr>
    </table>
</body>
</html>
